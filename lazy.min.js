(function(g){function n(a,c,d){return"function"===typeof d?n(d(a),d(c)):a===c?0:a>c?1:-1}function p(a,c){for(var d=0;d<a.length&&!1!==c(a[d]);++d);}function q(a,c){for(var d=0;d<a.length;++d)if(a[d]instanceof Array){if(!1===q(a[d],c))return!1}else if(!1===c(a[d]))return!1}var b=function(a,c){this.parent=a;this.source=c;this.depth=a?a.depth+1:0;this.parent||(this.arraysCreated=0)};b.prototype.get=function(a){return this.source?this.source[a]:this.parent.get(a)};b.prototype.length=function(){return this.source?
this.source.length:this.parent.length()};b.prototype.root=function(){for(var a=this;a.parent;)a=a.parent;return a};b.prototype.arrayCount=function(){return this.root().arraysCreated};b.prototype.each=function(a){p(this.source,a)};b.prototype.log=function(a){console.log(Array(this.depth).join("  ")+a)};b.prototype.toArray=function(){var a=[];this.each(function(c){a.push(c)});this.root().arraysCreated+=1;return a};b.prototype.toObject=function(){var a={};this.each(function(c){a[c[0]]=c[1]});return a};
b.prototype.map=function(a){return new h(this,a)};b.prototype.pluck=function(a){return new h(this,function(c){return c[a]})};b.prototype.invoke=function(a){return new h(this,function(c){return c[a]()})};b.prototype.filter=function(a){return new l(this,a)};b.prototype.reject=function(a){return new l(this,function(c){return!a(c)})};b.prototype.where=function(a){return new l(this,function(c){for(var d in a)if(c[d]!==a[d])return!1;return!0})};b.prototype.reverse=function(){return new r(this)};b.prototype.first=
b.prototype.head=b.prototype.take=function(a){return"undefined"===typeof a?this.get(0):new s(this,a)};b.prototype.initial=function(a){"undefined"===typeof a&&(a=1);return this.take(this.length()-a)};b.prototype.last=function(a){return"undefined"===typeof a?this.get(this.length()-1):this.reverse().first()};b.prototype.findWhere=function(a){return this.where(a).first()};b.prototype.rest=b.prototype.tail=b.prototype.drop=function(a){return new t(this,a)};b.prototype.sortBy=function(a){return new u(this,
a)};b.prototype.groupBy=function(a){return new v(this,a)};b.prototype.countBy=function(a){return new w(this,a)};b.prototype.uniq=function(){return new x(this)};b.prototype.zip=function(){var a=Array.prototype.slice.call(arguments,0);return new y(this,a)};b.prototype.shuffle=function(){return new z(this)};b.prototype.flatten=function(){return new A(this)};b.prototype.compact=function(){return this.filter(function(a){return!!a})};b.prototype.without=b.prototype.difference=function(){return new B(this,
Array.prototype.slice.call(arguments,0))};b.prototype.union=function(){return new C(this,Array.prototype.slice.call(arguments,0))};b.prototype.intersection=function(){return new D(this,Array.prototype.slice.call(arguments,0))};b.prototype.every=b.prototype.all=function(a){var c=!0;this.each(function(d){if(!a(d))return c=!1});return c};b.prototype.some=b.prototype.any=function(a){a||(a=function(){return!0});var c=!1;this.each(function(d){if(a(d))return c=!0,!1});return c};b.prototype.isEmpty=function(){return!this.any()};
b.prototype.indexOf=function(a){var c=0,d=-1;this.each(function(b){if(b===a)return d=c,!1;++c});return d};b.prototype.lastIndexOf=function(a){a=this.reverse().indexOf(a);-1!==a&&(a=this.length()-a-1);return a};b.prototype.sortedIndex=function(a){for(var c=0,d=this.length(),b;c<d;)b=c+d>>>1,this.get(b)<a?c=b+1:d=b;return c};b.prototype.contains=function(a){return-1!==this.indexOf(a)};b.prototype.reduce=b.prototype.inject=b.prototype.foldl=function(a,c){this.each(function(d){c=a(c,d)});return c};b.prototype.reduceRight=
b.prototype.foldr=function(a,c){return this.reverse().reduce(a,c)};b.prototype.find=b.prototype.detect=function(a){return this.filter(a).first()};b.prototype.min=function(){return this.reduce(function(a,c){return"undefined"===typeof a?c:c<a?c:a})};b.prototype.max=function(){return this.reduce(function(a,c){return"undefined"===typeof a?c:c>a?c:a})};b.inherit=function(a){var c=function(){b.call(this,arguments[0]);a.apply(this,arguments)};c.prototype=b.prototype;return c};var e=b.inherit(function(a){var c;
this.cache=function(){c||(c=this.toArray());return c};this.get=function(a){return this.cache()[a]};this.length=function(){return this.cache().length}});e.inherit=function(a){var c=function(){e.call(this,arguments[0]);a.apply(this,arguments)};c.prototype=e.prototype;return c};var h=b.inherit(function(a,c){this.get=function(d){return c(a.get(d))};this.each=function(d){a.each(function(a){return d(c(a))})}}),l=e.inherit(function(a,c){this.each=function(d){a.each(function(a){if(c(a))return d(a)})}}),r=
b.inherit(function(a){this.get=function(c){return a.get(a.length()-c-1)};this.length=function(){return a.length()};this.each=function(c){for(var d=a.length()-1;0<=d&&!1!==c(a.get(d));--d);}}),s=e.inherit(function(a,c){this.each=function(d){var b=0;a.each(function(a){a=d(a);return++b>=c?!1:a})}}),t=e.inherit(function(a,c){this.each=function(d){var b=0;a.each(function(a){if(!(b++<c))return d(a)})}}),u=e.inherit(function(a,c){this.each=function(d){var b=a.toArray();b.sort(function(a,d){return n(a,d,
c)});p(b,d)}}),v=e.inherit(function(a,c){this.each=function(d){var b={};a.each(function(a){var d=c(a);b[d]?b[d].push(a):b[d]=[a]});for(var k in b)d([k,b[k]])}}),w=e.inherit(function(a,c){this.each=function(d){var b={};a.each(function(a){a=c(a);b[a]=b[a]?b[a]+1:1});for(var k in b)d([k,b[k]])}}),x=e.inherit(function(a){this.each=function(c){var b={};a.each(function(a){if(!(a in b))return b[a]=!0,c(a)})}}),B=e.inherit(function(a,c){this.each=function(b){var f=new m(c);a.each(function(a){if(!f.contains(a))return b(a)})}}),
C=e.inherit(function(a,c){this.each=function(b){var f=new m;a.each(function(a){f.contains(a)||(f.add(a),b(a))});Lazy(c).flatten().each(function(a){f.contains(a)||(f.add(a),b(a))})}}),D=e.inherit(function(a,c){this.each=function(b){var f=Lazy(c).map(function(a){return new m(a)}).toArray();a.each(function(a){for(var c=0;c<f.length;++c)if(!f[c].contains(a))return;b(a)})}}),y=e.inherit(function(a,c){this.each=function(b){var f=0;a.each(function(a){a=[a];for(var e=0;e<c.length;++e)c[e].length>f&&a.push(c[e][f]);
++f;return b(a)})}}),z=e.inherit(function(a){this.each=function(c){for(var b=a.toArray(),f=b.length-1;0<f;--f){var e=b,g=Math.floor(Math.random()*f)+1,h=e[f];e[f]=e[g];e[g]=h;if(!1===c(b[f]))return}c(b[0])}}),A=e.inherit(function(a){this.each=function(c){a.each(function(a){return a instanceof Array?q(a,c):c(a)})}}),E=b.inherit(function(a){b.call(this);this.get=a;this.length=function(){throw"Cannot get the length of a generated sequence.";};this.each=function(c){for(var b=0;!1!==c(a(b++)););}});g.Lazy=
function(a){return a instanceof b?a:new b(null,a)};g.Lazy.generate=function(a){return new E(a)};g.Lazy.range=function(){var a=1<arguments.length?arguments[0]:0,c=1<arguments.length?arguments[1]:arguments[0],b=2<arguments.length?arguments[2]:1;return this.generate(function(c){return a+b*c}).take(Math.floor((c-a)/b))};var m=function(a){var b={};Lazy(a||[]).flatten().each(function(a){b[a]=!0});this.add=function(a){b[a]=!0};this.contains=function(a){return b[a]}}})("undefined"===typeof exports?window:
exports);
